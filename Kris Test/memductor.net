# Simple netlist to test memductor

vsin:vin 1 0  mag=4.5 freq=10Hz phase=-90

memd:w1 1 0 w = '3 * phi*phi + .1 * abs(phi) + 3e-3' 

.options maxdelta=1 maxiter=2000

#.analysis tran tstep=1ms tstop=95ms shell=1
#.analysis op intvars=1 elemop=1
#.analysis fdtd T = 0.1 nsamples=1024
#.analysis wd T=0.1 nsamples=1024 m = 0.3
.analysis cs T=0.1 nsamples=1024 m = 0.3 speed = 2000

#.plot fdtd 1
#.plot fdtd vsin:vin:i
#.plot fdtd memd:w1:vc

#.plot wd 1
#.plot wd vsin:vin:i
#.plot wd memd:w1:vc

.plot cs 1
.plot cs vsin:vin:i
.plot cs memd:w1:vc




#.plot tran 1 
#.plot tran memd:w1:vc
#.plot tran vsin:vin:i

.end

# In the shell, run the following commands to plot hysteresis loop:
import matplotlib.pyplot as plt
plt.figure()
plt.plot(getvec('1'), -getvec('vsin:vin:i'))

# Plot W(phi) as a function of time:
plt.figure()
# Current is in mA => plot in mS
wVec = -getvec('vsin:vin:i') / getvec('1')
plt.plot(timeVec, wVec)



